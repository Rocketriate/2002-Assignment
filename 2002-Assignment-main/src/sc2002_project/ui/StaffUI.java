package sc2002_project.ui;


import sc2002_project.entities.CareerCentreStaff;
import sc2002_project.entities.InternshipOpportunity;
import sc2002_project.entities.ReportCriteria;
import sc2002_project.controllers.ApprovalController;
import sc2002_project.controllers.ReportController;

import java.util.List;
import java.util.Scanner;
public class StaffUI {
    private String activeId;
    private final ApprovalController approvalController;
    private final ReportController reportController;
    private final Scanner sc = new Scanner(System.in);

    public StaffUI(ApprovalController approvalController, ReportController reportController) {
        this.activeId = null;
        this.approvalController = approvalController;
        this.reportController = reportController;
    }

    public void runMenu(CareerCentreStaff user, LoginUI loginUI) {
        System.out.println("Welcome, " + user.getName());
        activeId = user.getUserID();
        ReportCriteria criteria = new ReportCriteria(activeId);
        System.out.println("What would you like to do today?");
        System.out.println("1. View pending internship opportunities");
        System.out.println("2. Approve internship opportunities");
        System.out.println("3. View pending company representatives");
        System.out.println("4. Approve company representatives");
        System.out.println("5. View application withdrawal requests");
        System.out.println("6. Approve application withdrawal requests");
        System.out.println("7. Update viewing filters -> Report Generation");
        System.out.println("8. Change account password");
        System.out.println("9. Logout");
        boolean operation = true;
        while (operation) {
            System.out.println("Choose an option:");
            String choice = sc.nextLine().trim();
            switch (choice) {
                case "1":
                    this.approvalController.viewPendingOpp(activeId);
                    break;
                case "2":
                    this.approvalController.approveOpp(activeId);
                    break;
                case "3":
                    this.approvalController.viewPendingRep(activeId);
                    break;
                case "4":
                    this.approvalController.approveRep(activeId);
                    break;
                case "5":
                    this.approvalController.viewPendingWithdraw(activeId);
                    break;
                case "6":
                    this.approvalController.approveWithdraw(activeId);
                    break;
                case "7":
                    criteria = reportController.updateFilters(criteria);
                    List<InternshipOpportunity> result = reportController.generate(activeId, criteria);
                    printReport(result);
                    break;
                case "8":
                    loginUI.changePassword();
                    break;
                case "9":
                    operation = false;
                    break;
                default:
                    System.out.println("Error: Invalid choice. Please choose an option from 1-9");
                    break;
            }
        }
        activeId = null;
        System.out.println("Thank you for using the internship placement system");
        loginUI.logout();
        loginUI.start();
    }
    private void printReport(List<InternshipOpportunity> list) {
        System.out.println("\n=== Internship Opportunities Staff Report ===");
        if (list.isEmpty()) {
            System.out.println("No opportunities found matching the specified criteria.\n");
            return;
        }

        System.out.println("--------------------------------------------------------------------------------------------------");
        System.out.printf("%-4s | %-30s | %-15s | %-12s | %-12s | %-10s%n",
                "ID", "Title", "Company", "Level", "OppStatus", "Approved");
        System.out.println("--------------------------------------------------------------------------------------------------");

        for (InternshipOpportunity opp : list) {
            System.out.printf("%-4d | %-30s | %-15s | %-12s | %-12s | %-10d%n",
                    opp.getOppId(),
                    opp.getTitle(),
                    opp.getCompanyName(),
                    opp.getLevel(),
                    opp.getStatus(),
                    opp.getApprovedCount());
        }
        System.out.println("--------------------------------------------------------------------------------------------------");
        System.out.println("Total Opportunities in Report: " + list.size());
        System.out.println("Report completed.");
    }
}








































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































